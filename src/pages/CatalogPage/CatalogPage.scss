.CatalogPage {
    min-height: 100vh;
    padding: 100px 0 60px;
    background: linear-gradient(135deg, $primary-bg 0%, $secondary-bg 50%, $dark-blue 100%);
    position: relative;

    &::before {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at 20% 50%, rgba(255, 107, 107, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 80%, rgba(78, 205, 196, 0.1) 0%, transparent 50%);
        pointer-events: none;
    }
}

.container {
    max-width: 1525px;
    padding: 0 15px;
    margin: 0 auto;
}

.content-grid {
    display: block;
}

.content-left {
    min-width: 0;
}

.hero {
    text-align: center;
    margin: 20px 0 24px;
}

.title {
    font-family: 'Orbitron';
    font-size: 44px;
    font-weight: 800;
    color: #fff;
    margin: 0 0 10px;

    span {
        color: $accent-coral;
    }
}

.subtitle {
    color: #c7c7d3;
    max-width: 900px;
    margin: 0 auto;
}

.filters {
    background: rgba(26, 26, 46, .55);
    border: 1px solid rgba(255, 107, 107, .25);
    border-radius: 16px;
    padding: 22px 24px;
    position: relative;
    /* для корректного z-index дочерних поповеров */
    z-index: 10;
    margin-bottom: 40px;
}

.row {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 16px;
}

.row.grid {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr auto;
    gap: 16px;
    align-items: end;
    margin: 0;
}

/* Расширенная сетка фильтров */
.grid-filters {
    grid-template-columns: repeat(2, minmax(160px, 1fr));
    gap: 16px;
}

.filter-section,
details.filter-section {
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid rgba(255, 107, 107, 0.18);
    border-radius: 14px;
    padding: 14px 14px 12px;
    position: relative;
    transition: border-color .2s ease, box-shadow .2s ease, transform .2s ease;
}

details.filter-section {
    overflow: visible;
    position: relative;
    /* создаём контекст для абсолютных списков */
}

details.filter-section[open] {
    border-color: $accent-coral;
    box-shadow: 0 8px 22px rgba(255, 107, 107, .18);
    z-index: 2000;
    /* поверх соседних блоков */
}

details.filter-section:hover {
    border-color: $accent-coral;
    box-shadow: 0 8px 22px rgba(255, 107, 107, .18);
    transform: translateY(-2px);
}

.section-title,
details.filter-section>summary.section-title {
    font-family: 'Orbitron';
    font-weight: 800;
    font-size: 13px;
    letter-spacing: .4px;
    color: #eaeaff;
    background: linear-gradient(135deg, rgba(26, 26, 46, 0.9) 0%, rgba(22, 33, 62, 0.9) 100%);
    padding: 14px 16px;
    border-radius: 12px;
    border: 2px solid rgba(255, 107, 107, 0.28);
    margin: 0 0 12px;
    list-style: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: border-color .2s ease, box-shadow .2s ease, transform .2s ease;
}

details.filter-section>summary::-webkit-details-marker {
    display: none;
}

details.filter-section>summary.section-title::after {
    content: '\25BE';
    /* ▾ */
    color: #cfd3ff;
    font-size: 14px;
    transition: transform .25s ease;
}

details.filter-section[open]>summary.section-title::after {
    transform: rotate(180deg);
}

details.filter-section>summary.section-title:hover {
    border-color: $accent-coral;
    box-shadow: 0 12px 35px rgba(255, 107, 107, 0.2);
    transform: translateY(-2px);
}

.checks {
    display: none;
    /* скрыта по умолчанию, чтобы не толкать сетку */
    position: absolute;
    top: calc(100% + 10px);
    /* немного ниже, чтобы не налипало на summary */
    left: 0;
    right: auto;
    z-index: 3000;
    grid-template-columns: 1fr;
    gap: 8px;
    padding: 12px;
    background: rgba(26, 26, 46, 0.95);
    border: 1px solid rgba(255, 107, 107, 0.3);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.4);
    max-height: 320px;
    overflow: auto;
    min-width: 280px;
    max-width: min(640px, calc(100vw - 40px));
}

.checks.cols {
    grid-template-columns: repeat(2, minmax(180px, 1fr));
    gap: 8px 12px;
    min-width: 520px;
    max-width: min(760px, calc(100vw - 40px));
}

details.filter-section[open]>.checks {
    display: grid;
}

.check {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 10px;
    color: #dfe5ff;
    cursor: pointer;
    transition: background .2s ease, border-color .2s ease, transform .2s ease;
}

.check:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(78, 205, 196, .35);
}

.check input[type="checkbox"] {
    width: 16px;
    height: 16px;
    margin: 0;
    accent-color: $accent-coral;
}

.sort-list {
    display: none;
    /* поповер */
    position: absolute;
    top: calc(100% + 10px);
    left: 0;
    right: 0;
    z-index: 3000;
    background: rgba(26, 26, 46, 0.95);
    border: 1px solid rgba(255, 107, 107, 0.3);
    border-radius: 12px;
    backdrop-filter: blur(10px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, .4);
    padding: 10px;
    flex-direction: column;
    gap: 6px;
    min-width: 260px;
    max-width: min(520px, calc(100vw - 40px));
}

/* Выравниваем поповеры вправо для правого столбца грид-сетки */
.grid-filters>details.filter-section:nth-child(3n),
.grid-filters>details.filter-section.align-right {
    position: relative;
}

.grid-filters>details.filter-section:nth-child(3n)>.checks,
.grid-filters>details.filter-section:nth-child(3n)>.sort-list,
.grid-filters>details.filter-section.align-right>.checks,
.grid-filters>details.filter-section.align-right>.sort-list {
    left: auto;
    right: 0;
}

details.filter-section[open]>.sort-list {
    display: flex;
}

.sort-item {
    text-align: left;
    padding: 8px 10px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.06);
    background: rgba(255, 255, 255, 0.03);
    color: #cfd3ff;
    cursor: pointer;
    transition: background .2s ease, color .2s ease, border-color .2s ease, transform .2s ease;
}

.sort-item:hover {
    background: rgba(255, 255, 255, 0.06);
    color: #fff;
    transform: translateX(2px);
}

.sort-item.active {
    background: linear-gradient(45deg, $accent-coral, $hot-pink);
    color: #000;
    border-color: transparent;
}

.label {
    color: #cfd3ff;
    min-width: max-content;
}

.row-search {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
}

.row-search .label {
    margin-bottom: 2px;
}

.row-search .search {
    width: 100%;
}

.search {
    position: relative;
    flex: 1;
    display: flex;
    gap: 8px;
}

.input {
    flex: 1;
    height: 48px;
    padding: 0 14px;
    border-radius: 12px;
    background: #0f0e16;
    border: 1px solid #2a2036;
    color: #e9e9f4;
}

.icon-btn {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    background: linear-gradient(45deg, $accent-coral, $hot-pink);
    color: #000;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    cursor: pointer;
}

.icon-btn.clear {
    background: #2a2036;
    color: #d6d6e8;
    border: 1px solid rgba(255, 255, 255, .08);
}

.field {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.select {
    height: 44px;
    border-radius: 10px;
    background: #0f0e16;
    border: 1px solid #2a2036;
    color: #e9e9f4;
    padding: 0 12px;
}

.select.small {
    height: 40px;
}

.actions {
    display: flex;
    justify-content: flex-start;
    align-items: center;
}

.reset {
    height: 44px;
    padding: 0 14px;
    display: flex;
    align-items: center;
    gap: 10px;
    border-radius: 10px;
    background: #2a2a3b;
    color: #dfe5ff;
    border: 1px solid rgba(255, 255, 255, .08);
    cursor: pointer;
}

.toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 18px 0;
}

.found {
    color: #aeb3d1;
}

.sort {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #aeb3d1;
}

.grid-cards {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 24px;
}

.catalog-card {
    position: relative;
    display: block;
    height: 450px;
    border-radius: 16px;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 107, 107, 0.18);
    transition: transform .28s ease, box-shadow .28s ease, border-color .28s ease;
}

.catalog-card:hover {
    transform: translateY(-8px);
    border-color: $accent-coral;
    box-shadow: 0 14px 30px rgba(255, 107, 107, .25);
}

.catalog-card__image {
    position: absolute;
    inset: 0;
    background-size: cover;
    background-position: center;
    filter: brightness(0.9);
}

.catalog-card__overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(180deg, rgba(10, 10, 10, 0.0) 0%, rgba(10, 10, 15, 0.5) 45%, rgba(10, 10, 15, 0.9) 100%);
}

.catalog-card__content {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    padding: 14px 14px 16px;
}

.catalog-card__top {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 6px;
    justify-content: flex-end;
}

.status-badge {
    font-size: 11px;
    padding: 6px 10px;
    border-radius: 10px;
    font-weight: 800;
}

.status-badge--green {
    background: rgba(78, 205, 196, .9);
    color: #00110f;
}

.status-badge--gold {
    background: rgba(255, 206, 84, .95);
    color: #1b1200;
}

.catalog-card__title {
    color: #fff;
    font-family: 'Comfortaa';
    font-weight: 700;
    font-size: 16px;
    line-height: 1.35;
    margin: 0 0 8px;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    text-overflow: ellipsis;
}

.catalog-card__meta {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
}

.meta-rating {
    color: $accent-gold;
    display: flex;
    align-items: center;
    gap: 6px;
    font-weight: 700;
}

.meta-year {
    color: $accent-turquoise;
    font-weight: 700;
}

.catalog-card__genres {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.catalog-card__genres span {
    background: rgba(78, 205, 196, .18);
    color: $accent-turquoise;
    border: 1px solid rgba(78, 205, 196, .28);
    padding: 3px 8px;
    border-radius: 12px;
    font-size: 11px;
}


.sentinel {
    height: 1px;
}

.load-state {
    text-align: center;
    color: #aeb3d1;
    padding: 16px 0;
}

.load-state.end {
    opacity: .7;
}


// --- Адаптация с помощью миксинов ---

// Большие экраны (1600px)
@include respond(xxl) {
    .grid-cards {
        grid-template-columns: repeat(3, minmax(0, 1fr));
    }
}

// Десктопы (1280px)
@include respond(xl) {
    .grid-cards {
        grid-template-columns: repeat(3, minmax(0, 1fr));
    }
}

// Ноутбуки (1024px)
@include respond(lg) {
    .grid-cards {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }
}

// Планшеты (768px)
@include respond(md) {

    .row.grid,
    .grid-filters {
        grid-template-columns: 1fr;
    }

    .grid-cards {
        grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .toolbar {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .title {
        font-size: 38px;
    }
}

// Мобильные (480px)
@include respond(sm) {
    .grid-cards {
        grid-template-columns: 1fr;
    }

    .title {
        font-size: 32px;
    }

    .subtitle {
        font-size: 15px;
    }

    .filters {
        padding: 18px 16px;
    }

    .catalog-card {
        height: 430px;
    }

    .checks,
    .sort-list {
        min-width: calc(100vw - 50px);
    }
}